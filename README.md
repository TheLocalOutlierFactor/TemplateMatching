# Template Matching
Тестирование подходов по сопоставлению шаблонов.

Шаблонами являются фотографии вблизи товаров на полке в магазине, изображением же для сопоставления шаблонов является панорамная фотография всей полки с данными товарами.

В файле *TM_OpenCV.ipynb* реализована функция по сопоставлению шаблонов средствами библиотеки OpenCV. В ней используются простые математические методы для нахождения шаблона на изображении. Работает такой подход достаточно быстро, но качество не слишком хорошее, хотя можно увидеть, что какие-то из шаблонов были найдены правильно.

В файле *TM_QATM.ipynb* реализован метод Quality-Aware Template Matching For Deep Learning (https://arxiv.org/abs/1903.07254). Реализация выполнена с помощью фреймворка PyTorch. В методе используется предобученная сверточная нейронная сеть для извлечения features из изображения и шаблонов (архитектура VGG19). На ЦПУ работает алгоритм достаточно долго, на сопоставление 10 шаблонов с одним изображением размера 3024х4032, которое было уменьшено до 40% от оригинального размера (1210х1613), ушло около 2 минут 10 секунд. На ГПУ метод работал несколько секунд. Качество же результата значительно лучше, чем у OpenCV, модель правильно обнаружила все 10 тестовых шаблонов.
